<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <title>Idlast.pw</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <meta name="description" content=""> 
  <meta name="author" content=""> 
  <!-- Le styles --> 
  <link href="bootstrap/css/bootstrap.css" rel="stylesheet"> 
  <link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet"> 
  <link href="css/styles7.css" rel="stylesheet"> 
  <style type="text/css">/* css for timepicker */
        .ui-timepicker-div .ui-widget-header { margin-bottom: 8px; }
        .ui-timepicker-div dl { text-align: left; }
        .ui-timepicker-div dl dt { float: left; clear:left; padding: 0 0 0 5px; }
        .ui-timepicker-div dl dd { margin: 0 10px 10px 45%; }
        .ui-timepicker-div td { font-size: 90%; }
        .ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }

        .ui-timepicker-rtl{ direction: rtl; }
        .ui-timepicker-rtl dl { text-align: right; padding: 0 5px 0 0; }
        .ui-timepicker-rtl dl dt{ float: right; clear: right; }
        .ui-timepicker-rtl dl dd { margin: 0 45% 10px 10px; }</style> 
  <script src="bootstrap/js/jquery.js"></script> 
  <script src="bootstrap/js/bootstrap.min.js"></script> 
  <script type="text/javascript" src="js/ui/jquery-ui.min.js"></script> 
  <link rel="stylesheet" href="js/themes/base/minified/jquery-ui.min.css"> 
  <script type="text/javascript" src="js/ui/jquery-ui-timepicker-addon.js"></script> 
  <link rel="shortcut icon" href="/iDLast_favicon_16x16.ico"> 
  <!-- HTML5 shim, for IE6-8 support of HTML5 elements --> 
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <![endif]--> 
  <!-- Fav and touch icons --> 
  <script src="js/star-rating/jquery.rating.js" type="text/javascript"></script> 
  <link href="js/star-rating/jquery.rating.css" type="text/css" rel="stylesheet"> 
  <script src="js/jquery-cookie-master/src/jquery.cookie.js" type="text/javascript"></script> 
  <script type="text/javascript">
        function show_cnt_notread_msg(){
            $.ajax({
                dataType: "JSON",
                url:"/mods/get-messages-cnt.php",
                cache:false,
                success:function(json){
                    if(json["cnt"] > 0) {
                        $("#email_link").addClass("email_red");
                        $("#mess_cnt_div").html(json["cnt"]);
                    }
                }
            });
        }
        //show_cnt_notread_msg();
        setInterval('show_cnt_notread_msg()',60000);
    </script> 
 </head> 
 <body> 
  <div class="container-fluid" style="padding: 0"> 
   <div class="navbar row-fluid"> 
    <div class="span12 navbar-inner"> 
     <div class="span2" style="max-width: 200px !important;"> 
      <a class="brand" href="/index.php">iDLast <span><sup>beta</sup></span></a> 
     </div> 
     <div class="span10"> 
      <div class="span10"> 
       <div class="psevdotwitt">
        <a href="https://money.yandex.ru/to/410011128203187">Улучшить</a> iDlast
       </div> 
      </div> 
      <div class="span2"> 
       <ul class="nav navbuttons pull-left"> 
        <li class="li_message"><a id="email_link" class="email_link" href="/messages.php" title="Сообщения"></a>
         <div id="mess_cnt_div" class="mess_cnt_div"></div></li> 
        <li><a class="faq_link" href="/blog.php?art=39" title="FAQ"></a></li> 
        <li><a class="settings_link" href="#" onclick="getContent('settings', 'mainContent')" data-toggle="tooltip" title="Настройки" data-placement="left"></a></li> 
        <li><a href="exit.php" class="padding_lr_null">Выйти</a></li> 
       </ul> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div class="container-fluid"> 
   <div class="row-fluid"> 
    <div class="span2 leftsidebar"> 
     <a href="#" onclick="getContent('addNew', 'mainContent'); location.hash = 'addNew'; return false;" class="btn btn-idlast">ДОБАВИТЬ</a> 
     <ul class="nav nav-pills nav-stacked"> 
      <li class="lid_menu lid_all"><a href="#" onclick="getActionContent('getCat', { type : 'all' }, 'mainContent'); location.hash = 'getCat|all';  return false;">Засланцы</a></li> 
      <li><a href="/service.php">Найти</a></li> 
      <!--<li class="lid_menu lid_my"><a href="#" onclick="getContent('my', 'mainContent'); location.hash = 'my'; return false;">Мои засланцы</a></li>--> 
      <!--<li class="lid_menu lid_vector"><a href="#" onclick="getActionContent('getCat', { type : 'vector' }, 'mainContent'); location.hash = 'getCat|vector'; return false;">Вектора</a></li>--> 
      <!--<li class="lid_menu lid_image"><a href="#" onclick="getActionContent('getCat', { type : 'image' }, 'mainContent'); location.hash = 'getCat|image'; return false;">Иллюстрации</a></li>--> 
      <!--<li class="lid_menu lid_photo"><a href="#" onclick="getActionContent('getCat', { type : 'photo' }, 'mainContent'); location.hash = 'getCat|photo'; return false;">Фото</a></li>--> 
      <!--<li class="lid_menu lid_addNew"><a href="#" onclick="getContent('addNew', 'mainContent'); location.hash = 'addNew'; return false;">Добавить засланца</a></li>--> 
      <!--<li class="lid_menu lid_stats"><a href="#" onclick="getContent('stats', 'mainContent'); location.hash = 'stats';  return false;">Статистика</a></li>--> 
      <li><a href="/stata.php">Статистика</a></li> 
      <li><a href="/blog.php">Блог</a></li> 
      <!--<li class="lid_menu lid_support"><a href="#" onclick="getContent('support', 'mainContent'); location.hash = 'support'; return false;">Техподдержка</a></li>--> 
      <li class="lid_menu lid_chat"><a href="#" onclick="getContent('chat', 'mainContent'); location.hash = 'chat';  return false;">Уютный чатик</a></li> 
     </ul> 
     <!--<div id="chatZasl"></div>--> 
     <div class="float_leftside_block"> 
      <b>Время надписи:</b>
      <br> 
      <div id="dellegend-8242">
        10:31 argenlant: 1 мин.
       <br> 
      </div> 
      <div id="dellegend-8243">
        12:45 switchpipipi: 1 мин.
       <br> 
      </div> 
      <div id="dellegend-8244">
        12:47 imuse: 10 мин.
       <br> 
      </div> 
      <div id="dellegend-8245">
        12:58 nas_net: 11 мин.
       <br> 
      </div> 
      <div id="dellegend-8246">
        14:13 diamondy: 22 мин.
       <br> 
      </div> 
      <br> 
      <div id="chatZaslPartOne"></div> 
      <div class="claim_div">
        Жаловаться по адресу
       <br>
       <a href="mailto:admin@idlast.com">admin@idlast.com</a> 
      </div> 
     </div> 
    </div> 
    <div class="span10"> 
     <div class="span12" id="mainContent"></div> 
    </div> 
   </div> 
  </div> 
  <script type="text/javascript">
    
    function getContent(section, result){
        if (typeof timeout_id != 'undefined'){
            clearTimeout(timeout_id);
            delete window.timeout_id;
        }
        $("#chatZasl").html("");
        $.post("http://idlast.com/ajax.php", { action: "getContent", section : section}, function(data){
            $("#"+result).html(data);
            $(".lid_menu").removeClass("active");
            $(".lid_"+section).addClass("active");
        })
    }

    function getActionContent(action, params, result){
        if (typeof timeout_id != 'undefined'){
            clearTimeout(timeout_id);
            delete window.timeout_id;
        }
        $.post("http://idlast.com/ajax.php", { action: action, params : params}, function(data){
            $("#"+result).html(data);
            if (action == "getCat"){
                $(".lid_menu").removeClass("active");
               // $(".lid_"+params.type).addClass("active");
                $(".lid_all").addClass("active");
            }
        })
    }

    function getActionCallbackContent(action, params, result, clb_name, clb_result){
        if (typeof timeout_id != 'undefined'){
            clearTimeout(timeout_id);
            delete window.timeout_id;
        }
        $.post("http://idlast.com/ajax.php", { action: action, params : params}, function(data){
            $("#"+result).html(data);
            getContent(clb_name, clb_result);
        })
    }

    function getActionCallbackMenu(action, params, result, clb_name, clb_params, clb_result){
        if (typeof timeout_id != 'undefined'){
            clearTimeout(timeout_id);
            delete window.timeout_id;
        }
        $.post("http://idlast.com/ajax.php", { action: action, params : params}, function(data){
            $("#"+result).html(data);
            getActionContent(clb_name, clb_params, clb_result);
        })
    }
    
    function getActionCallbackWithoutContent(action, params, result){
        if (typeof timeout_id != 'undefined'){
            clearTimeout(timeout_id);
            delete window.timeout_id;
        }
        $.post("http://idlast.com/ajax.php", { action: action, params : params}, function(data){
            //$("#"+result).html(data);
            alert("Действие выполнено!");
        })
    }

    function ping(){
        $.post("http://idlast.com/ajax.php", { action: "ping"}, function(data){

        })
    }

    var hash = location.hash.replace('#','');

    if(hash != ''){
        var needed = explode("|", hash);
        if (needed[0] == "getCat"){
            getActionContent('getCat', { type : needed[1] }, 'mainContent');
        }
        else {
            getContent(needed[0], 'mainContent');
        }
    }
    else {
        //getContent('my', 'mainContent');
        getActionContent('getCat', { type : 'all' }, 'mainContent');
        //location.hash = 'getCat|all';
    }

    function explode( delimiter, string ) {	// Split a string by string
        //
        // +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
        // +   improved by: kenneth
        // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)

        var emptyArray = { 0: '' };

        if ( arguments.length != 2
                || typeof arguments[0] == 'undefined'
                || typeof arguments[1] == 'undefined' )
        {
            return null;
        }

        if ( delimiter === ''
                || delimiter === false
                || delimiter === null )
        {
            return false;
        }

        if ( typeof delimiter == 'function'
                || typeof delimiter == 'object'
                || typeof string == 'function'
                || typeof string == 'object' )
        {
            return emptyArray;
        }

        if ( delimiter === true ) {
            delimiter = '1';
        }

        return string.toString().split ( delimiter.toString() );
    }


    setInterval(ping, 300000);
</script> 
  <script type="text/javascript">
    $("#chatZaslPartOne").html("");
    //$("#chatZaslPartOne").html($("#chatZaslPartOne").html() + "<br>Онлайн 72 человек<br />");
    
        $("#chatZaslPartOne").html("<div style='padding:4px; border:solid 1px #c9c9c9; border-radius:5px; background: #f4f4f4'><p style='line-height: 1.5; margin:0 0 5px 0'>Ваши засланцы:</p><p style='line-height: 1.5; margin:0 0 5px 0'>Тип: <span style='color:#008000'>vector</span><br />Осталось: 12000<br/>Времени: 0 ч. 13 мин. <br /></p>");       
    $("#chatZaslPartOne").html($("#chatZaslPartOne").html() + "<br />Онлайн 72 человек");
</script> 
  <script type="text/javascript">
    
    $( document ).on( "change", "#type_zasl_select", function( e ) {
        $("#total_items").html("Загружается ...");
        $('#my_checkbox').prop('checked', false);
        $('#waiting_checkbox').prop('checked', false);
        //$('#waiting_block').hide();
        $('.my_block').hide();
        
        if( $("#type_zasl_select").val() == 'getCat|all' ){
            $.cookie('type_zasl_select', 'all');  
            getActionContent('getCat', { type : 'all' }, 'mainContent'); location.hash = 'getCat|all'; window.location.reload(); //return false;
        } else if( $("#type_zasl_select").val() == 'getCat|vector' ){
            $.cookie('type_zasl_select', 'vector');  
            getActionContent('getCat', { type : 'vector' }, 'mainContent'); location.hash = 'getCat|vector'; window.location.reload(); //return false;
        } else if( $("#type_zasl_select").val() == 'getCat|image' ){
            $.cookie('type_zasl_select', 'image'); 
            getActionContent('getCat', { type : 'image' }, 'mainContent'); location.hash = 'getCat|image'; window.location.reload(); //return false;
        } else if( $("#type_zasl_select").val() == 'getCat|photo' ){
            $.cookie('type_zasl_select', 'photo'); 
            getActionContent('getCat', { type : 'photo' }, 'mainContent'); location.hash = 'getCat|photo'; window.location.reload(); //return false;
        } else if( $("#type_zasl_select").val() == 'getCat|footage' ){
            $.cookie('type_zasl_select', 'footage'); 
            getActionContent('getCat', { type : 'footage' }, 'mainContent'); location.hash = 'getCat|footage'; window.location.reload(); //return false;
        } else if( $("#type_zasl_select").val() == 'getCat|editorial' ){
            $.cookie('type_zasl_select', 'editorial'); 
            getActionContent('getCat', { type : 'editorial' }, 'mainContent'); location.hash = 'getCat|editorial'; window.location.reload(); //return false;
        }
        
         
        
	//window.location.href = "#";
    });
    
    $( document ).on( "change", "#my_checkbox", function( e ) {
        //alert( $("#my_checkbox").val() );
        
        //window.location.href = "#";
        if( $('#my_checkbox').prop('checked') ){            
            //getContent('my', 'mainContent'); location.hash = 'my'; return false;
            $('.my_block').show();
            $('#total_items').hide();
            var tp = 'all';
            if( $( "#type_zasl_select option:selected" ).attr('title') != '' ) {
                tp = $( "#type_zasl_select option:selected" ).attr('title');
            }
            
            /////
             $.ajax({
		    type: "GET",
		    url: "/mods/approved.php?tp=" + tp,
                    cache: false,
		    success: function(html){
			$("#approved_ajax").html(html);
                    },
                    beforeSend: function(){
                        $("#approved_ajax").html('<br />Загрузка данных ... ');
                    }
                    
            });
             
            
             
        } else{
            $('.my_block').hide();
            $('#total_items').show();
            $("#approved_ajax").html('');
        }
        
	//window.location.href = "#";
    });
    
    $( document ).on( "change", "#waiting_checkbox", function( e ) {
        if( $('#waiting_checkbox').prop('checked') ){            
            //$('#waiting_block').show();
            $('.tr_unappr').toggle();
            
            var tp = 'all';
            if( $( "#type_zasl_select option:selected" ).attr('title') != '' ) {
                tp = $( "#type_zasl_select option:selected" ).attr('title');
            }
    
            /////
             $.ajax({
		    type: "GET",
		    url: "/mods/unapproved.php?tp=" + tp,
                    cache: false,
		    success: function(html){
			$("#unapproved_ajax").html(html);
                    },
                    beforeSend: function(){
                        $("#unapproved_ajax").html('<br /><img src="/images/design/ajax-loader.gif" /> Загрузка данных ... <br /><br />');
                    }
                    
            });
             
        } else{
            //$('#waiting_block').hide();
            $('.tr_unappr').toggle();
            $("#unapproved_ajax").html('');
        }
    });
    
    
    
    
    
    $( document ).on( "click", ".delItem, .delTotalItem, .delUnapprovedItem", function( e ) {
        
        //if (confirm("Вы действительно хотите удалить засланца?")){
            id_str = this.id;
	    split_arr = id_str.split("_");
            
            getActionContent('delItem', { id : split_arr[1] }, 'tmp');
            //jQuery(this).parent().parent('.my_block').hide();
            jQuery(this).parent().parent().hide();
        //}
        e.preventDefault();
    });
    
    function approve(id){
        $.post("ajax.php", { action : "getApprovePicker", id: id }, function(data){
            $("#divApprove"+id).html(data);
            $("#dtp"+id).datetimepicker({ dateFormat: "dd.mm.yy" });
        })
        //e.preventDefault();
    }
    
    function approveTotal(id){
        $.post("ajax.php", { action : "getApprovePicker", id: id }, function(data){
            $("#divApproveTotal"+id).html(data);
            $("#dtp"+id).datetimepicker({ dateFormat: "dd.mm.yy" });
        })
        //e.preventDefault();
    }
    
    function approveUnapproved(id){
        $.post("ajax.php", { action : "getApproveUnapprovedPicker", id: id }, function(data){
            $("#divApproveUnapproved"+id).html(data);
            $("#dtp"+id).datetimepicker({ dateFormat: "dd.mm.yy" });
        })
        //e.preventDefault();
    }
    
    /*
    function moveItem(id){
        //alert(this.id);
        if (confirm("Вы действительно хотите перевести засланца в непринятые?")){
            //getActionCallbackContent('moveItem', { id : id }, 'tmp', 'my', 'mainContent');
            //getActionCallbackWithoutContent('moveItem', { id : id }, 'tmp');
            //jQuery(this).parent().parent().parent().hide();
        }
    }
    */
    
     $( document ).on( "click", ".mvitem", function( e ) {
        
        if (confirm("Вы действительно хотите перевести засланца в непринятые?")){
            id_str = this.id;
	    split_arr = id_str.split("_");
            getActionCallbackWithoutContent('moveItem', { id : split_arr[1] }, 'tmp');
            jQuery(this).parent().parent().parent().hide();
        }
        e.preventDefault();
    });



    function setApprove(id){
        if (confirm("Вы уверены, что дата точная?")){
            //alert("df");
            getActionCallbackWithoutContent('approveItem', { id : id, date : $("#dtp"+id).val() }, 'tmp');
            $("#apprvd_"+id).html( $("#dtp"+id).val().replace(/\./g, "-") );
            $("#apprvdtotal_"+id).html( $("#dtp"+id).val().replace(/\./g, "-") );
            $("#divApproveTotal"+id).html('');
            //getActionCallbackContent('approveItem', { id : id, date : $("#dtp"+id).val() }, 'tmp', 'my', 'mainContent');
        }
    }
    
    function setApproveUnapproved(id){
        if (confirm("Вы уверены, что дата точная?")){
            
            getActionCallbackWithoutContent('approveItem', { id : id, date : $("#dtp"+id).val() }, 'tmp');
            //jQuery(this).parent().parent().parent().hide();
            $("#tr_unpr_"+id).hide("slow");
        }
    }

    function shitHappens(id){
        if (confirm("Вы уверены, что Вас пропустили? Рекомендуем нажимать данную кнопку только имея несколько подтверждений этого на форуме/в системе!")){
            getActionCallbackContent('shitHappens', { id : id }, 'tmp', 'my', 'mainContent');
        }
    }
    
    
   

    function setWatcher(itemId, typeId, value){
        if (confirm("Вы действительно хотите подписаться или отказаться от подписки на этого засланца?")){
            $.post("ajax.php", { action : "setWatcher", itemId : itemId, typeId : typeId, value : value}, function(data){
                if (data.status == "OK"){
                    $("#watch_"+itemId+"_1").html("<strong>OK</strong>");
                }
                else {
                    alert(data.message);
                }
            }, "json");
        }
    }

        
</script> 
  <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-52272447-1', 'auto');
        ga('send', 'pageview');

    </script>   
 </body>
</html>